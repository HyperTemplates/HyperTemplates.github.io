!function(e){var t=function(){};t.test=document.createElement("div"),t.randomiseArray=function(e){var t,a,n,i=[],o=[];for(t=0;t<e;t++)i[t]=t;for(a=0;a<e;a++)n=Math.round(Math.random()*(i.length-1)),o[a]=i[n],i.splice(n,1);return o},t.sortArray=function(e,t){var a,n=e.length,i=[];for(a=0;a<n;a++)i[a]=e[t[a]];return i},t.keysrt=function(e,t,a){var n=1;return a&&(n=-1),e.sort((function(e,a){var i=e[t],o=a[t];return n*(i<o?-1:i>o?1:0)}))},t.keysrt2=function(e,t,a,n){var i=1;return n&&(i=-1),e.sort((function(e,n){var o=e[t][a],r=n[t][a];return i*(o<r?-1:o>r?1:0)}))},t.getUrlParameter=function(t){var a={};return e.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,t,n){a[t]=n})),t?a[t]:a},t.formatTime=function(e){var t=Math.round(e,10),a=Math.floor(t/3600),n=Math.floor((t-3600*a)/60);e=t-3600*a-60*n;return a>0?(a<10&&(a="0"+a),n<10&&(n="0"+n),e<10&&(e="0"+e),a+":"+n+":"+e):(n<10&&(n="0"+n),e<10&&(e="0"+e),n+":"+e)},t.isScrolledIntoView=function(t){var a=t.getBoundingClientRect(),n=a.top,i=a.bottom;return n+a.height/2>=0&&i-a.height/2<=e.innerHeight},t.sortNumericArray=function(e){e.sort((function(e,t){return e-t}))},t.getEvents=function(){var t={};return"ontouchstart"in e?(t.downEvent="touchstart mousedown",t.moveEvent="touchmove mousemove",t.upEvent="touchend mouseup"):e.PointerEvent?(t.downEvent="pointerdown",t.moveEvent="pointermove",t.upEvent="pointerup"):(t.downEvent="mousedown",t.moveEvent="mousemove",t.upEvent="mouseup"),t},t.isEmpty=function(e){return 0==e.replace(/^\s+|\s+$/g,"").length},t.canPlayVorbis=function(){var e=document.createElement("video");return!(!e.canPlayType||!e.canPlayType('video/ogg; codecs="theora, vorbis"').replace(/no/,""))},t.canPlayMp4=function(){var e=document.createElement("video");return!(!e.canPlayType||!e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,""))},t.canPlayWebM=function(){var e=document.createElement("video");return!(!e.canPlayType||!e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/no/,""))},t.audioSupport=function(){return Boolean(document.createElement("audio").canPlayType)},t.canPlayMp3=function(){var e=document.createElement("audio");return!(!e.canPlayType||!e.canPlayType("audio/mpeg;").replace(/no/,""))},t.canPlayWav=function(){var e=document.createElement("audio");return!(!e.canPlayType||!e.canPlayType("audio/wav;").replace(/no/,""))},t.canPlayAac=function(){var e=document.createElement("audio");return!(!e.canPlayType||!e.canPlayType("audio/aac;").replace(/no/,""))},t.canPlayOgg=function(){var e=document.createElement("audio");return!(!e.canPlayType||!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/no/,""))},t.isMobile=function(){return!!(t.hasPointerEvent&&navigator.msMaxTouchPoints>1)||/Android|webOS|iPhone|iPad|iPod|sony|BlackBerry/i.test(navigator.userAgent)},t.isIOS=function(){return navigator.userAgent.match(/(iPad|iPhone|iPod)/g)},t.isAndroid=function(){return navigator.userAgent.indexOf("Android")>-1},t.isiPad=function(){return navigator.userAgent.indexOf("iPad")>-1},t.isiPhoneIpod=function(){var e=navigator.userAgent;return e.indexOf("iPhone")>-1||e.indexOf("iPod")>-1},t.isSafari=function(){return Object.prototype.toString.call(e.HTMLElement).indexOf("Constructor")>0},t.isChrome=function(){var t=navigator.userAgent,a=!(Object.prototype.toString.call(e.HTMLElement).indexOf("Constructor")>0)&&"WebkitTransform"in document.documentElement.style;return(t.indexOf("iPhone")>-1||t.indexOf("iPod")>-1||t.indexOf("iPad")>-1)&&t.match("CriOS")&&(a=!0),a},t.parseXML=function(t){if(e.ActiveXObject&&e.GetObject){var a=new ActiveXObject("Microsoft.XMLDOM");return a.loadXML(t),a}if(e.DOMParser)return(new DOMParser).parseFromString(t,"text/xml");throw new Error("No XML parser available")},t.baseUrl=function(){return e.location.href.replace(e.location.hash,"")},t.protocol=function(){return e.location.protocol},t.qualifyURL=function(e){var t=document.createElement("a");return t.href=e,t.href},t.hasLocalStorage=function(){try{return"localStorage"in e&&null!==e.localStorage}catch(e){return!1}},t.validateEmail=function(e){return!!/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(e)},t.hasDownloadSupport=function(e){return"download"in document.createElement("a")},t.relativePath=function(e){return new RegExp("^(?:[a-z]+:)?//","i").test(e)},t.hasFullscreen=function(){return t.test.requestFullscreen||t.test.mozRequestFullScreen||t.test.msRequestFullscreen||t.test.oRequestFullscreen||t.test.webkitRequestFullScreen},t.counter=function(e){return e<9?"0"+(e+1):e+1},t.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},t.hmsToSecondsOnly=function(e){for(var t=e.split(":"),a=0,n=1;t.length>0;)a+=n*parseInt(t.pop()),n*=60;return a},e.AWPUtils=t}(window),function(e,t){"use strict";e.AWPPlaybackRateSlider=function(a){var n,i=this,o=t(document),r=t(e),l=AWPUtils.isMobile(),s=a.wrapper,d=a.tooltip,u=a.sliderBg,c=a.sliderLevel,p=(a.seekbarHolder,a.seekbar),f=u.width(),m=AWPUtils.getEvents(),h=Number(a.settings.playbackRateMin),g=Number(a.settings.playbackRateMax);function y(e){var t=Math.max(0,Math.min(1,(e.pageX-u.offset().left)/f));i.setValue(t)}if(p.on(m.downEvent,(function(e){return function(e){if(!n){if("touchstart"==e.type){var t=e.originalEvent.touches;if(!(t&&t.length>0))return!1;t[0]}else e,e.preventDefault();n=!0,o.on(m.moveEvent,(function(e){!function(e){var t;if("touchmove"==e.type){var a;if(e.originalEvent.touches&&e.originalEvent.touches.length)a=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;a=e.originalEvent.changedTouches}if(a.length>1)return!1;t=a[0],e.preventDefault()}else t=e,e.preventDefault();y(t),v(t)}(e)})).on(m.upEvent,(function(e){!function(e){if(n){var t;if(n=!1,o.off(m.moveEvent).off(m.upEvent),"touchend"==e.type){var a;if(e.originalEvent.touches&&e.originalEvent.touches.length)a=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;a=e.originalEvent.changedTouches}if(a.length>1)return!1;t=a[0],e.preventDefault()}else t=e,e.preventDefault();y(t),d.hide()}}(e)}))}}(e),!1})),this.setValue=function(e){AWPUtils.isNumber(f)||(f=u.width()),c.css("width",e*f+"px");var a=h+(g-h)*e;a=Math.round(10*a)/10,t(i).trigger("AWPPlaybackRateSlider.RANGE_CHANGE",{value:a})},this.setVisual=function(e){var t=(e-h)/(g-h);AWPUtils.isNumber(f)||(f=u.width()),c.css("width",t*f+"px")},!l){function w(){p.off(m.moveEvent,v).off("mouseout",w),o.off("mouseout",w),d.hide()}p.on("mouseover",(function(){n||(p.on(m.moveEvent,v).on("mouseout",w),o.on("mouseout",w))}))}function v(e){var t=e.pageX-u.offset().left;t<0?t=0:t>f&&(t=f);var a=Math.max(0,Math.min(1,t/f));if(!AWPUtils.isNumber(a))return!1;var n=h+(g-h)*a;n=Math.round(10*n)/10,d.text(n);var i=s[0].getBoundingClientRect(),o=p[0].getBoundingClientRect(),l=parseInt(e.pageX-r.scrollLeft()-i.left-d.outerWidth()/2),c=parseInt(o.top-i.top-d.outerHeight());l<o.left-i.left?l=o.left-i.left:l>o.left-i.left+p.outerWidth()-d.outerWidth()&&(l=o.left-i.left+p.outerWidth()-d.outerWidth()),d.css({left:l+"px",top:c+"px"}).show()}l||this.setVisual(a.settings.playbackRate)}}(window,jQuery),function(e,t){"use strict";e.AWPDownloadManager=function(a){var n,i,o,r,l,s,d=AWPUtils.isMobile(),u=(t("body"),t(document),a.parent),c=a.settings.sourcePath;a.playerHolder;function p(e,a,n){var r="mail="+e+"&title="+a+"&path="+n;t.ajax({type:"POST",url:c+"includes/mail.php",data:r}).done((function(e){o=!1})).fail((function(e,t,a){console.log("Send email error: "+e.responseText),f(),o=!1})),i.css({marginTop:parseInt(-i.height()/2,10)+"px",display:"block"}).stop().animate({opacity:1},{duration:500}),s&&clearTimeout(s),s=setTimeout(f,2e3)}function f(){s&&clearTimeout(s),i.stop().animate({opacity:0},{duration:500,complete:function(){i.css("display","none")}})}function m(){for(var e=prompt("Please enter your email address where download link will be sent:");(!AWPUtils.validateEmail(e)||AWPUtils.isEmpty(e))&&null!=e;)e=prompt("Please enter a valid email address:");return e}this.setData=function(){n=u.find("iframe.awp-dl-iframe").length>0?u.find("iframe.awp-dl-iframe"):t('<iframe class="awp-dl-iframe"/>').css({position:"absolute",left:"-10000px",display:"none"}).appendTo(u),d&&(i=u.find(".awp-download-confirm"))},this.download=function(t,a){if(o)return!1;if("file:"==e.location.protocol)return console.log("Downloading files locally is not possible! This requires online server connection."),!1;var i=function(e,t){e.indexOf("\\")&&(e=e.replace(/\\/g,"/"));e.match(/^http([s]?):\/\/.*/)||(e=AWPUtils.qualifyURL(e));d||(t=t.replace(/[^A-Z0-9\-\_\.]+/gi,"_"));t.length>50&&(t=t.substr(0,50)+"...");d||/\.(mp3)$/i.test(t)||(t+=".mp3");return{title:t,path:e}}(t,a);!function(e,t){if(d){o=!0,r||(l=m())&&(r=!0),l?p(l,t,e):o=!1}else n.attr("src",c+"includes/dl.php?path="+e+"&title="+t)}(i.path,i.title)},this.setData()}}(window,jQuery),function(e,t){"use strict";e.AWPSCLoader=function(e){var a,n,i,o,r,l,s=this,d=e.settings,u="awp_sc_at"+d.instanceName,c=[],p=[];function f(){var e=[{name:"action",value:"sc_get_auth"},{name:"id",value:"678567"},{name:"sck",value:d.scak[Math.floor(Math.random()*d.scak.length)]}];t.ajax({url:d.sourcePath+"includes/sc/sc2.php",type:"post",data:e,dataType:"json"}).done((function(e){var t=JSON.parse(e);a=t.access_token,t.refresh_token,t.soundCloudExpiredTimeInSeconds=t.expires_in+g()-10,localStorage.setItem(u,JSON.stringify(t)),"url_request"==n?y():"download"==n?download():"get_stream_url"==n&&m()})).fail((function(e,t,a){console.log(e.responseText)}))}function m(){var e=[{name:"action",value:"sc_get_stream_url"},{name:"track_id",value:i},{name:"access_token",value:a}];t.ajax({url:d.sourcePath+"includes/sc/sc2.php",type:"post",data:e,dataType:"json"}).done((function(e){var a=JSON.parse(e);a.location?t(s).trigger("AWPSCLoader.GET_STREAM_URL",a.location):console.log("stream url not valid?",a)})).fail((function(e,t,a){console.log(e.responseText)}))}function h(){var e=localStorage.getItem(u);if(e){var t=JSON.parse(e);return a=t.access_token,g()<t.soundCloudExpiredTimeInSeconds}return!1}function g(){return.001*Date.now()}function y(){var e=[{name:"action",value:"sc_get_request"},{name:"access_token",value:a},{name:"url",value:o}];t.ajax({url:d.sourcePath+"includes/sc/sc2.php",type:"post",data:e,dataType:"json"}).done((function(e){var n=JSON.parse(e);n.location?function(e){var n=[{name:"action",value:"sc_get_request"},{name:"access_token",value:a},{name:"url",value:e}];t.ajax({url:d.sourcePath+"includes/sc/sc2.php",type:"post",data:n,dataType:"json"}).done((function(e){var a=JSON.parse(e);if(c=[],"track"==a.kind)c.push(v(a));else if("playlist"==a.kind){var n,i,o=a.tracks.length;for(n=0;n<o;n++)i=v(a.tracks[n]),n<l?c.push(i):p.push(i)}else a.collection||a.username||t.isArray(a);t(s).trigger("AWPSCLoader.END_LOAD",{data:c,nextPageToken:p})})).fail((function(e,t,a){console.log(e.responseText)}))}(n.location):console.log("sc request fail?")})).fail((function(e,t,a){console.log(e.responseText)}))}function v(e){if(e.streamable&&e.stream_url){var a=t.extend(!0,{},r);return a.type="audio",a.origtype="soundcloud",a.id=e.id,e.duration&&(a.duration=e.duration/1e3),e.downloadable&&e.download_url&&(a.download=e.download_url),!a.title&&e.title&&(a.title=e.title),!a.description&&e.description&&(a.description=e.description),!a.thumb&&e.artwork_url&&(a.thumb=e.artwork_url),e.created_at&&(a.date=e.created_at),a.favoritingsCount=parseInt(e.favoritings_count?e.favoritings_count:0,10),a.playbackCount=parseInt(e.playback_count?e.playback_count:0,10),a.hotness=a.favoritingsCount+a.playbackCount,e.permalink_url&&d.createLinkIconsInPlaylist&&(a.link||(a.link=e.permalink_url)),a.sc_data=e,a}}this.get_stream_url=function(e){i=e,m()},this.resume=function(){h()?m():(n="get_stream_url",f())},this.request=function(e,t){n="url_request",p=[],l=t,r=e;var a="https://api.soundcloud.com/resolve?url="+e.path;o=a,h()?y():f()}}}(window,jQuery),function(e,t){"use strict";e.AWPShareManager=function(t){var a,n=AWPUtils.isMobile(),i=t.settings,o="https:"==e.location.protocol?"https:":"http:";this.setData=function(){a=i.facebookAppId||i.fbk,AWPUtils.isEmpty(a)?console.log("Facebook api key has not been set in settings!"):function(t){var a,n;if(!e.FB&&t&&!document.body.querySelector("#fb-root"))(n=document.createElement("script")).text="window.fbAsyncInit=function(){FB.init({appId:'"+t+"',status:true,xfbml:true})};(function(e,t,n){var r,i=e.getElementsByTagName(t)[0];if(e.getElementById(n)){return}r=e.createElement(t);r.id=n;r.src='"+o+"//connect.facebook.net/en_US/all.js';i.parentNode.insertBefore(r,i)})(document,'script','facebook-jssdk')",(a=document.createElement("div")).id="fb-root",document.body.appendChild(a),document.body.appendChild(n)}(a)},this.share=function(t,a,r){var l,s,d=(e.screen.width-600)/2,u=(e.screen.height-300)/2,c=a.description||"",p=a.thumb?AWPUtils.qualifyURL(a.thumb):"",f=a.title||"";if(s=a.share?a.share:e.location.href+r,AWPUtils.relativePath(p)||(p=AWPUtils.qualifyURL(p)),"facebook"==t)FB.ui({method:"share",href:s},(function(e){}));else if("twitter"==t)l=o+"//twitter.com/share?url="+encodeURIComponent(s)+"&text="+encodeURIComponent(f);else if("tumblr"==t)l=o+"//www.tumblr.com/share/link?url="+encodeURIComponent(s)+"&amp;name="+encodeURIComponent(f)+"&amp;description="+encodeURIComponent(c);else if("whatsapp"==t){if(n){var m="whatsapp://send?text="+(encodeURIComponent(f)+" - "+encodeURIComponent(s));return void(e.location.href=m)}alert(i.whatsAppWarning)}l&&e.open(l,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width=600,height=300,left="+d+",top="+u)},this.setData()}}(window,jQuery),function(e,t){"use strict";e.AWPPlaylistManager=function(e){var a=this;function n(){a.playlistItems<3?a.randomPlay=!1:a.randomArr=AWPUtils.randomiseArray(a.playlistItems)}this.loopingOn=e.loopingOn,this.randomPlay=e.randomPlay,this.playlistItems,this.lastInOrder=!1,this.counter=-1,this.lastPlayedFromPlaylistClick,this.lastRandomCounter,this.randomPaused=!1,this.randomArr=[],this.playlistSelect=!1,this.setCounter=function(e,i){void 0===i&&(i=!0),i?a.counter+=parseInt(e,10):a.counter=parseInt(e,10),function(){if(isNaN(a.counter))return void alert("AWPPlaylistManager message: No active media, counter = "+a.counter);a.lastInOrder=!1,a.loopingOn?(a.randomPlay?a.counter>a.playlistItems-1?(a.counter=a.randomArr[a.playlistItems-1],n(),function(){if(a.randomArr[0]==a.counter){var e=a.randomArr.splice(0,1);a.randomArr.push(e)}}(),a.counter=0,t(a).trigger("AWPPlaylistManager.PLAYLIST_END_ALERT")):a.counter<0&&(a.counter=a.randomArr[0],n(),function(){if(a.randomArr[a.playlistItems-1]==a.counter){var e=a.randomArr.splice(a.playlistItems-1,1);a.randomArr.unshift(e)}}(),a.counter=a.playlistItems-1):a.counter>a.playlistItems-1?(a.counter=0,t(a).trigger("AWPPlaylistManager.PLAYLIST_END_ALERT")):a.counter<0&&(a.counter=a.playlistItems-1),t(a).trigger("AWPPlaylistManager.COUNTER_READY")):(a.counter>a.playlistItems-1?(a.counter=a.playlistItems-1,a.lastInOrder=!0):a.counter<0&&(a.counter=0),a.lastInOrder?t(a).trigger("AWPPlaylistManager.PLAYLIST_END"):t(a).trigger("AWPPlaylistManager.COUNTER_READY"))}()},this.getCounter=function(){return a.randomPlay?a.playlistSelect?a.counter:a.randomArr[a.counter]:a.counter},this.advanceHandler=function(e){a.playlistSelect=!1,a.randomPaused?function(e){if(a.randomPaused=!1,a.lastRandomCounter+e>a.playlistItems-1)return a.counter=a.playlistItems-1,void t(a).trigger("AWPPlaylistManager.COUNTER_READY");if(a.lastRandomCounter+e<0)return a.counter=0,void t(a).trigger("AWPPlaylistManager.COUNTER_READY");a.setCounter(a.lastRandomCounter+e,!1)}(e):a.setCounter(e)},this.processPlaylistRequest=function(e){a.playlistSelect=!1,a.randomPlay&&(a.playlistSelect=!0,a.lastPlayedFromPlaylistClick=e,a.randomPaused||(a.lastRandomCounter=a.counter,a.randomPaused=!0)),this.setCounter(e,!1)},this.setPlaylistItems=function(e,t){void 0===t&&(t=!0),t&&(a.counter=-1),a.playlistItems=e,a.randomPlay&&n()},this.reSetCounter=function(e){if(void 0===e)a.counter=-1;else{var t=parseInt(e,10);a.playlistItems?(t>a.playlistItems-1?t=a.playlistItems-1:t<0&&(t=0),a.counter=t):a.counter=-1}},this.setRandom=function(e){a.randomPlay=e,a.randomPlay&&n(),a.randomPlay?(function(){var e,t,n=a.randomArr.length;for(e=0;e<n;e++)if(a.randomArr[e]==a.counter){if(0==e)break;t=a.randomArr.splice(e,1),a.randomArr.unshift(parseInt(t,10));break}}(),a.counter=0):a.randomPaused?(a.counter=a.lastPlayedFromPlaylistClick,a.randomPaused=!1):a.counter=a.randomArr[a.counter]},this.setLooping=function(e){a.loopingOn=e}}}(window,jQuery),function(t){t.fn.awp=function(a){"use strict";var n=t.extend(!0,{},{instanceName:"",sourcePath:"",playlistList:"",activePlaylist:"",resumeTime:null,activeItem:0,volume:.5,autoPlay:!1,preload:"auto",randomPlay:!1,loopingOn:!0,iconLink:'<i class="fa fa-cart-plus"></i>',iconDownload:'<i class="fa fa-download"></i>',mediaEndAction:"loop",sck:"",seekTime:10,useMediaSession:!0,sortOrder:"",usePlaylistScroll:!1,whatsAppWarning:"Please share this content on mobile device!",allowSeeking:1,playlistScrollType:"mcustomscrollbar",playlistScrollOrientation:"vertical",playlistScrollTheme:"light",fbk:"",useNumbersInPlaylist:!1,numberTitleSeparator:".  ",artistTitleSeparator:" - ",pcmLength:100,pcmAccuracy:100,continousKey:"awp-continous-key",playlistItemContent:"title",createDownloadIconsInPlaylist:!1,linkIconTooltip:"Purchase",downloadIconTooltip:"Download",soundCloudThumbQuality:"t300x300.jpg",playbackRateMin:.5,playbackRateMax:2,playbackRate:1,waveformLoaderText:"Loading...",s3ThumbExtension:"jpg",s3UrlExpireTime:"+15 seconds",s3Region:"us-east-1",cf_expire:300,createLinkIconsInPlaylist:!1,togglePlaybackOnMultipleInstances:!0,wavesurfer:{waveColor:"#A8DBA8",progressColor:"#ff33ff",barWidth:0,barRadius:0,barGap:1,cursorColor:"#0000ff",cursorWidth:3,height:200},keyboardControls:[{keycode:37,action:"seekBackward"},{keycode:39,action:"seekForward"},{keycode:32,action:"togglePlayback"},{keycode:38,action:"volumeUp"},{keycode:40,action:"volumeDown"},{keycode:77,action:"toggleMute"},{keycode:33,action:"nextMedia"},{keycode:34,action:"previousMedia"},{keycode:82,action:"rewind"}]},a),i=AWPUtils.getUrlParameter(),o=[],r=[],l=["type","audio","path","limit","thumb","title","description","artist","album","download","duration","date","id3","start","end","link","target","peak-name","peak-array","bucket","key","playback-rate","remote","sort"];i["awp-query-instance"]&&decodeURIComponent(i["awp-query-instance"])==n.instanceName&&function(){if(Object.keys(i).forEach((function(e){if(0==e.indexOf("awp-")){var t=e.substr(4).replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()})),a=decodeURIComponent(i[e]).replace(/\+/g," ");a&&(n.hasOwnProperty(t)?("true"===a?a=!0:"false"===a&&(a=!1),n[t]=a):(a=a.split(",").map((function(e){return e.trim()})),l.indexOf(t)>-1&&o.push({key:t,value:a})))}})),o.length){var e,t,a,s,d,u=o.length,c=o[0].value.length;for(t=0;t<c;t++){for(s={},e=0;e<u;e++)"true"===(d=(a=o[e]).value[t])?d=!0:"false"===d&&(d=!1),s[a.key]=d,"type"===a.key&&(s.origtype=d);r.push(s)}}}(),i=null;var s,d,u,c,p,f,m,h,g,y,v,w,b,k,P,T,A,I,E,x,C,S,W,M,U,_,R,D,O,N,L,j=t(this).show(),q=t(n.playlistList).hide(),B=j.find(".awp-playlist-holder"),H=j.find(".awp-playlist-inner"),F=j.find(".awp-playlist-content"),G=j.find(".awp-playlist-filter-msg"),V=j.find(".awp-sort-alpha"),z=j.find(".awp-preloader"),X=j.find(".awp-tooltip"),Y=j.find(".awp-player-holder"),K=j.find(".awp-waveform"),J=j.find(".awp-player-thumb"),Q=j.find(".awp-player-title"),$=j.find(".awp-player-artist"),Z=j.find(".awp-player-desc"),ee=j.find(".awp-media-time-current"),te=j.find(".awp-media-time-total"),ae=(j.find(".awp-player-controls"),j.find(".awp-playback-toggle")),ne=j.find(".awp-playback-toggle-ex"),ie=j.find(".awp-player-toggle-ex"),oe=j.find(".awp-loop-toggle"),re=j.find(".awp-player-volume"),le=j.find(".awp-random-toggle"),se=(j.find(".awp-volume-wrapper"),j.find(".awp-volume-seekbar")),de=j.find(".awp-volume-bg"),ue=j.find(".awp-volume-level"),ce=j.find(".awp-share-holder"),pe=j.find(".awp-share-toggle"),fe=j.find(".awp-share-close"),me=j.find(".awp-playback-rate-toggle"),he=j.find(".awp-playback-rate-close"),ge=j.find(".awp-playback-rate-holder"),ye=j.find(".awp-waveform-wrap"),ve=j.find(".awp-waveform-preloader"),we=j.find(".awp-waveform-img"),be=j.find(".awp-waveform-img-load"),ke=j.find(".awp-waveform-img-progress-wrap"),Pe=j.find(".awp-waveform-img-progress"),Te=AWPUtils.isMobile(),Ae=AWPUtils.canPlayMp3(),Ie=AWPUtils.canPlayWav(),Ee=AWPUtils.canPlayAac(),xe=AWPUtils.isIOS(),Ce=AWPUtils.hasLocalStorage(),Se=n.autoPlay,We=Se,Me=n.loopingOn,Ue=n.randomPlay,_e=n.playlistItemContent.split(","),Re=n.useMediaSession&&"mediaSession"in navigator&&"file:"!=window.location.protocol,De=n.useContinousPlayback&&Ce,Oe=n.useGa&&n.gaTrackingId,Ne=B.length,Le=j.find(".awp-search-filter").length,je=ee.length||te.length,qe=se.length,Be=n.sortOrder,He=!1,Fe=!1,Ge=this,Ve=(t("body"),t(window)),ze=t(document),Xe=(AWPUtils.isChrome(),AWPUtils.isSafari(),AWPUtils.hasDownloadSupport()),Ye="ebsfm:",Ke=AWPUtils.getEvents(),Je=["audio","s3_audio"],Qe={},$e="scroll.autoplay"+n.instanceName,Ze=n.sourcePath+"includes/ba-simple-proxy.php",et=-1,tt=[],at=[],nt=[],it=0,ot=!1,rt=null,lt=!1,st=!1;if(n.breakPointArr&&"string"==typeof n.breakPointArr&&(n.breakPointArr=n.breakPointArr.split(","),AWPUtils.sortNumericArray(n.breakPointArr)),n.disableSongSkip&&(n.allowSeeking=0),n.sck||n.soundCloudAppId){var dt=n.sck||n.soundCloudAppId;n.scak=dt.split(",").map((function(e){return e.trim()}))}function ut(){n.stickyPlayerOpened?(j.find(".awp-btn-player-close").show(),j.find(".awp-btn-player-open").hide()):(j.find(".awp-btn-player-close").hide(),j.find(".awp-btn-player-open").show())}V.find(".awp-btn-sort-alpha-asc").show(),ae.find(".awp-btn-play").show(),void 0===window.ap_mediaArr&&(window.ap_mediaArr=[]),ap_mediaArr.push({inst:Ge,id:n.instanceName}),Te&&(Se=!1),n.autoPlayInViewport&&(Se=!1),ca(),ua(),da(),ie.on("click",(function(){var e=Y.height();n.stickyPlayerOpened?Y.stop().animate({bottom:-e+"px"},{duration:350}):Y.stop().animate({bottom:"0px"},{duration:350}),n.stickyPlayerOpened=!n.stickyPlayerOpened,ut()})),ne.on("click",(function(){if(!He)return!1;Ge.togglePlayback()})),Oe&&(window.ga||function(e,t,a,n,i,o,r){e.GoogleAnalyticsObject=i,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,o=t.createElement(a),r=t.getElementsByTagName(a)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",r.parentNode.insertBefore(o,r)}(window,document,"script",0,"ga"),ga("create",n.gaTrackingId,"auto"),ga("send","pageview")),!Te&&X.length&&("static"==j.css("position")&&console.log("player css position is static, therefore tooltip might not work correctly. Please set wrapper css position to other than static if you use tooltip in player."),j.on("mouseenter","[data-tooltip]",(function(e){var a=t(this),n=j[0].getBoundingClientRect(),i=a[0].getBoundingClientRect();X.text(a.attr("data-tooltip"));var o=parseInt(i.top-n.top-X.outerHeight()),r=parseInt(i.left-n.left-X.outerWidth()/2+a.outerWidth()/2),l=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;r+n.left<0?r=parseInt(i.left-n.left+15):r+n.left+X.outerWidth()>l&&(r=parseInt(i.left+i.width-n.left-X.outerWidth())),o+n.top<0&&(o=parseInt(i.top-n.top+X.outerHeight()+15)),X.css({left:r+"px",top:o+"px"}).show()})).on("mouseleave","[data-tooltip]",(function(e){X.hide()})));var ct=j.find(".awp-playback-rate-seekbar");j.find(".awp-playback-rate-min").html(n.playbackRateMin),j.find(".awp-playback-rate-max").html(n.playbackRateMax),ct.length&&(h=new AWPPlaybackRateSlider({settings:n,wrapper:j,seekbarHolder:j.find(".awp-playback-rate-wrap"),seekbar:ct,sliderBg:j.find(".awp-playback-rate-bg"),sliderLevel:j.find(".awp-playback-rate-level"),tooltip:X}),t(h).on("AWPPlaybackRateSlider.RANGE_CHANGE",(function(e,t){Ge.setPlaybackRate(t.value)}))),Le&&j.find(".awp-search-filter").on("keyup",(function(){var e,a,n,i=t(this).val().toLowerCase(),o=0;for(e=0;e<it;e++)a="",(n=F.find(".awp-playlist-item").eq(e)).find(".awp-playlist-title").length&&(a+=n.find(".awp-playlist-title").html().toLowerCase()),a.indexOf(i)>-1?n.removeClass("awp-filter-hidden").show():(n.addClass("awp-filter-hidden").hide(),o++);o==it?(G.show(),I=!1):(G.hide(),I=!0)}));var pt=new AWPDownloadManager({settings:n,parent:j});F.on("click",".awp-download",(function(){e.preventDefault();var a=t(this).closest(".awp-playlist-item").attr("data-id"),i=tt[a].data,o=ia(i);Oe&&"undefined"!=typeof ga&&ga("send",{hitType:"event",eventCategory:"Audio Waveform Player: "+n.instanceName,eventAction:"downloaded",eventLabel:"title: "+o,nonInteraction:!0}),void 0!==i.download&&pt.download(i.download,o)}));var ft=new AWPShareManager({settings:n}),mt=new AWPPlaylistManager({randomPlay:n.randomPlay,loopingOn:n.loopingOn});if(t(mt).on("AWPPlaylistManager.COUNTER_READY",(function(){U&&$t(),W=mt.getCounter(),R=tt[W].data,U=R.type,Ne&&function(e){M&&Nt();if((M=F.children(".awp-playlist-item[data-id="+e+"]")).length){if(M.addClass("awp-playlist-selected awp-playlist-item-disabled"),n.usePlaylistScroll&&it>0){if(!D)if("mcustomscrollbar"==n.playlistScrollType)if("undefined"!=typeof mCustomScrollbar)setTimeout((function(){"horizontal"==n.playlistScrollOrientation?H.mCustomScrollbar("scrollTo",parseInt(M.position().left),{scrollInertia:500}):H.mCustomScrollbar("scrollTo",parseInt(M.position().top),{scrollInertia:500})}),1e3);else var t=setInterval((function(){"undefined"!=typeof mCustomScrollbar&&(clearInterval(t),"horizontal"==n.playlistScrollOrientation?H.mCustomScrollbar("scrollTo",parseInt(M.position().left),{scrollInertia:500}):H.mCustomScrollbar("scrollTo",parseInt(M.position().top),{scrollInertia:500}))}),100);else"perfect-scrollbar"==n.playlistScrollType&&setTimeout((function(){"horizontal"==n.playlistScrollOrientation?H.stop().animate({scrollTop:M[0].offsetLeft+"px"},{duration:500}):H.stop().animate({scrollTop:M[0].offsetTop+"px"},{duration:500})}),1e3);D=!1}"undefined"!=typeof awpPlaylistItemDisabled&&awpPlaylistItemDisabled(Ge,n.instanceName,M)}}(W),oa(),"s3_audio"==U?function(e){-1!=e.key.indexOf(Ye)&&(e.key=AWPUtils.b64DecodeUnicode(e.key.substr(6)));if(n.useCloudfront)var a=n.sourcePath+"includes/aws/aws2.php";else a=n.sourcePath+"includes/aws/aws.php";var i={object_key:e.key,bucket:e.bucket,action:"get_url",region:n.s3Region,expire:n.s3UrlExpireTime,cf_expire:n.cf_expire,cred:n.s3,upload_dir:n.upload_dir};t.ajax({type:"GET",url:a,data:i,dataType:"json"}).done((function(e){U="audio",R.path=e,R.peakData,Ht()})).fail((function(e,t,a){console.log(e,t,a),n.autoAdvanceToNextSongOnError&&Ge.nextMedia()}))}(R):Ht(),"undefined"!=typeof awpItemTriggered&&awpItemTriggered(Ge,n.instanceName,W)})).on("AWPPlaylistManager.PLAYLIST_END AWPPlaylistManager.PLAYLIST_END_ALERT",(function(){"undefined"!=typeof awpPlaylistEnd&&awpPlaylistEnd(Ge,n.instanceName)})),De){var ht=xe?"pagehide":"beforeunload";(window.attachEvent||window.addEventListener)(ht,(function(e){return window.event&&(window.event.cancelBubble=!0),!!He&&(!!U&&void gt())})),xe&&document.addEventListener("unload",(function(e){gt()}))}else localStorage.removeItem(n.continousKey);function gt(){var e={activePlaylist:n.activePlaylist,volume:n.volume,activeItem:W,resumeTime:Ge.getCurrentTime(),autoPlay:st};localStorage.setItem(n.continousKey,JSON.stringify(e))}Re&&(navigator.mediaSession.setActionHandler("play",(function(){Ge.playMedia()})),navigator.mediaSession.setActionHandler("pause",(function(){Ge.pauseMedia()})),navigator.mediaSession.setActionHandler("previoustrack",(function(){Ge.previousMedia()})),navigator.mediaSession.setActionHandler("nexttrack",(function(){Ge.nextMedia()})),navigator.mediaSession.setActionHandler("seekbackward",(function(){Ge.seekBackward()})),navigator.mediaSession.setActionHandler("seekforward",(function(){Ge.seekForward()})));var yt,vt=!!se.hasClass("awp-vertical"),wt=.5,bt=null!=n.volumeSize?n.volumeSize:vt?de.height():de.width();function kt(e){if(!He)return!1;n.volume>0?(wt=n.volume,n.volume=0):n.volume=wt,Tt()}function Pt(e){vt?(n.volume=Math.max(0,Math.min(1,(e.pageY-de.offset().top)/bt)),n.volume=1-n.volume):n.volume=Math.max(0,Math.min(1,(e.pageX-de.offset().left)/bt)),Tt()}function Tt(e){void 0!==e&&(n.volume=e),y&&(y.volume=n.volume),qe&&(vt?ue.css("height",n.volume*bt+"px"):ue.css("width",n.volume*bt+"px")),re.children().hide(),0==n.volume?re.find(".awp-btn-volume-off").show():n.volume>0&&n.volume<.5?re.find(".awp-btn-volume-down").show():re.find(".awp-btn-volume-up").show(),"undefined"!=typeof awpVolumeChange&&awpVolumeChange(Ge,n.instanceName,n.volume)}if(n.volume<0?n.volume=0:n.volume>1&&(n.volume=1),0!=n.volume&&(wt=n.volume),re.hasClass("awp-volume-toggable")&&re.on("click",(function(){kt(!0)})),se.length&&se.on(Ke.downEvent,(function(e){return function(e){if(!yt){if("touchstart"==e.type){var t=e.originalEvent.touches;if(!(t&&t.length>0))return!1;t[0]}else e,e.preventDefault();yt=!0,ze.on(Ke.moveEvent,(function(e){!function(e){var t;if("touchmove"==e.type){var a;if(e.originalEvent.touches&&e.originalEvent.touches.length)a=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;a=e.originalEvent.changedTouches}if(a.length>1)return!1;t=a[0],e.preventDefault()}else t=e,e.preventDefault();Pt(t),At(t)}(e)})).on(Ke.upEvent,(function(e){!function(e){if(yt){var t;if(yt=!1,ze.off(Ke.moveEvent).off(Ke.upEvent),"touchend"==e.type){var a;if(e.originalEvent.touches&&e.originalEvent.touches.length)a=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;a=e.originalEvent.changedTouches}if(a.length>1)return!1;t=a[0],e.preventDefault()}else t=e,e.preventDefault();Pt(t),X.hide()}}(e)}))}}(e),!1})),X.length&&!Te){function fa(){se.off(Ke.moveEvent,At).off("mouseout",fa),ze.off("mouseout",fa),X.hide()}se.on("mouseover",(function(){yt||(se.on(Ke.moveEvent,At).on("mouseout",fa),ze.on("mouseout",fa))}))}function At(e){if(vt)t=e.pageY-de.offset().top;else var t=e.pageX-de.offset().left;t<0?t=0:t>bt&&(t=bt);var a=Math.max(0,Math.min(1,t/bt));if(!AWPUtils.isNumber(a))return!1;vt&&(a=1-a);var n=parseInt(100*a,10);X.text(n+" %");var i=j[0].getBoundingClientRect(),o=se[0].getBoundingClientRect();if(vt){var r=parseInt(o.left-i.left-X.outerWidth()/2+se.outerWidth()/2);(l=parseInt(e.pageY-Ve.scrollTop()-i.top-X.outerHeight()-20))<o.top-i.top-X.outerHeight()-10?l=o.top-i.top-X.outerHeight()-10:l>o.top-i.top+se.outerHeight()-X.outerHeight()&&(l=o.top-i.top+se.outerHeight()-X.outerHeight())}else{r=parseInt(e.pageX-Ve.scrollLeft()-i.left-X.outerWidth()/2);var l=parseInt(o.top-i.top-X.outerHeight())-10;r<o.left-i.left?r=o.left-i.left:r>o.left-i.left+se.outerWidth()-X.outerWidth()&&(r=o.left-i.left+se.outerWidth()-X.outerWidth())}l+i.top<0&&(l=parseInt(o.top-i.top+X.outerHeight()+20)),X.css({left:r+"px",top:l+"px"}).show()}if(!Te){function ma(){ye.off(Ke.moveEvent,It).off("mouseout",ma),ze.off("mouseout",ma),X.hide()}ye.on("mouseover",(function(){ye.on(Ke.moveEvent,It).on("mouseout",ma),ze.on("mouseout",ma)}))}function It(e){var t=e.pageX-ye.offset().left;t<0?t=0:t>ye.width()&&(t=ye.width());var a=Math.max(0,Math.min(1,t/ye.width()));if(!AWPUtils.isNumber(a))return!1;parseInt(100*a,10);if(y)var n=y.duration;if(AWPUtils.isNumber(n)){var i=AWPUtils.formatTime(n*a)+" / "+AWPUtils.formatTime(n);X.text(i);var o=j[0].getBoundingClientRect(),r=ye[0].getBoundingClientRect(),l=parseInt(e.pageX-Ve.scrollLeft()-o.left-X.outerWidth()/2),s=parseInt(r.top+r.height/2-o.top-X.outerHeight()-25);l<r.left-o.left?l=r.left-o.left:l>r.left-o.left+ye.outerWidth()-X.outerWidth()&&(l=r.left-o.left+ye.outerWidth()-X.outerWidth()),s+o.top<0&&(s=parseInt(r.top-o.top+X.outerHeight()+20)),X.css({left:l+"px",top:s+"px"}).show()}}function Et(e){if(!He)return!1;var a=e.keyCode;if(t(e.target).hasClass("awp-search-filter"))return!0;var i,o,r=n.keyboardControls.length;for(i=0;i<r;i++)if(a==(o=n.keyboardControls[i]).keycode){if("seekBackward"==o.action)Ge.seekBackward(n.seekTime);else if("seekForward"==o.action)Ge.seekForward(n.seekTime);else if("togglePlayback"==o.action)Ge.togglePlayback();else if("volumeUp"==o.action)n.volume+=.1,n.volume>1&&(n.volume=1),Ge.setVolume(n.volume);else if("volumeDown"==o.action)n.volume-=.1,n.volume<0&&(n.volume=0),Ge.setVolume(n.volume);else if("toggleMute"==o.action)Ge.toggleMute();else if("nextMedia"==o.action)Ge.nextMedia();else if("previousMedia"==o.action)Ge.previousMedia();else{if("rewind"!=o.action)return!0;Ge.seek(0)}break}return!1}n.useKeyboardNavigationForPlayback&&n.keyboardControls.length&&(Array.isArray(n.keyboardControls)||(n.keyboardControls=n.keyboardControls.split(";")),n.useGlobalKeyboardControls?ze.on("keydown.awp",(function(e){return Et(e)})):j.hover((function(){ze.on("keydown",(function(e){return Et(e)}))}),(function(){ze.off("keydown")})));var xt,Ct,St=[j.find(".awp-next-toggle"),j.find(".awp-prev-toggle"),j.find(".awp-playlist-toggle"),j.find(".awp-share-item"),V,re,ae,oe,le,pe,fe,me,he,j.find(".awp-skip-backward"),j.find(".awp-skip-forward")],Wt=St.length;for(Ct=0;Ct<Wt;Ct++)xt=t(St[Ct]).css("cursor","pointer").on("click",Rt),Te||xt.on("mouseenter",Dt).on("mouseleave",Ot);function Mt(e){if(e.preventDefault(),!He)return!1;if(n.disableSongSkip)return!1;var a=t(e.currentTarget),i=a.closest(".awp-playlist-item").attr("data-id");if(a.closest(".awp-playlist-item").hasClass("awp-playlist-item-disabled"))return n.togglePlaybackOnPlaylistItem?(Ge.togglePlayback(),!1):(Ge.seek(0),st||Ge.playMedia(),!1);D=!0,mt.processPlaylistRequest(i),"undefined"!=typeof awpPlaylistItemClick&&awpPlaylistItemClick(Ge,n.instanceName,a,i,e)}function Ut(e){if(e.preventDefault(),!He)return!1;var a=t(e.currentTarget),i=a.closest(".awp-playlist-item").attr("data-id");tt[i].data;if(i==W)return!1;a.closest(".awp-playlist-item").addClass("awp-playlist-selected"),"undefined"!=typeof awpPlaylistItemRollover&&awpPlaylistItemRollover(Ge,n.instanceName,a)}function _t(e){if(e.preventDefault(),!He)return!1;var a=t(e.currentTarget);if(a.closest(".awp-playlist-item").attr("data-id")==W)return!1;a.closest(".awp-playlist-item").removeClass("awp-playlist-selected"),"undefined"!=typeof awpPlaylistItemRollout&&awpPlaylistItemRollout(Ge,n.instanceName,a)}function Rt(e){if(!He)return!1;var a=t(e.currentTarget);a.hasClass("awp-prev-toggle")?Ge.previousMedia():a.hasClass("awp-playback-toggle")?Ge.togglePlayback():a.hasClass("awp-skip-backward")?Ge.seekBackward(n.seekTime):a.hasClass("awp-skip-forward")?Ge.seekForward(n.seekTime):a.hasClass("awp-next-toggle")?Ge.nextMedia():a.hasClass("awp-playlist-toggle")?B.toggle():a.hasClass("awp-loop-toggle")?(Me=!Me,mt.setLooping(Me),ua()):a.hasClass("awp-player-volume")?a.hasClass("awp-toggle-mute")&&kt():a.hasClass("awp-share-toggle")?(ge.is(":visible")&&ge.hide(),ce.toggle()):a.hasClass("awp-share-close")?ce.toggle():a.hasClass("awp-playback-rate-toggle")?(ce.is(":visible")&&ce.hide(),ge.toggle()):a.hasClass("awp-playback-rate-close")?ge.toggle():a.hasClass("awp-random-toggle")?(Ue=!Ue,mt.setRandom(Ue),ca()):a.hasClass("awp-sort-alpha")?(AWPUtils.isEmpty(Be)?Be="title-asc":"title-asc"==Be?Be="title-desc":"title-desc"==Be&&(Be="title-asc"),Ge.sort(Be),da()):a.hasClass("awp-share-item")&&ft.share(a.attr("data-type").toLowerCase(),R,Ge.getCurrentMediaUrl())}function Dt(e){if(!He)return!1;if(e.preventDefault(),"undefined"!=typeof _AWPTouchManager&&_AWPTouchManager.isDrag())return!1;var a=t(e.currentTarget);a.find("i");a.addClass("awp-icon-hover")}function Ot(e){if(!He)return!1;e.preventDefault();var a=t(e.currentTarget);a.find("i");a.hasClass("awp-random-toggle")&&Ue||a.hasClass("awp-loop-toggle")&&Me||a.removeClass("awp-icon-hover")}function Nt(){M&&(M.removeClass("awp-playlist-selected awp-playlist-item-disabled"),"undefined"!=typeof awpPlaylistItemEnabled&&awpPlaylistItemEnabled(Ge,n.instanceName,M),M=null)}function Lt(){if(v=!1,g.on("ended",(function(){Jt()})).on("canplay",(function(e){})).on("loadedmetadata",(function(){setTimeout((function(){v||g.trigger("canplay")}),1e3)})).on("canplay",(function(){if(!v){if(v=!0,R.playbackRate)try{y.playbackRate=Number(R.playbackRate)}catch(e){}n.resumeTime?(y.currentTime=n.resumeTime,delete n.resumeTime):R.start&&(y.currentTime=R.start);var e=y.duration;AWPUtils.isNumber(e)&&te.html(AWPUtils.formatTime(e)),Tt(n.volume),n.autoPlayInViewport&&!x&&(AWPUtils.isScrolledIntoView(j[0])?(x=!0,Se=!0,Ge.playMedia()):Ve.on($e,(function(){C||(C=!0,AWPUtils.isScrolledIntoView(j[0])?(x=!0,Se=!0,Ge.playMedia()):x||setTimeout((function(){C=!1}),250))}))),We&&(Se=!0)}})).on("canplaythrough",(function(){})).on("play",(function(){!function(){if(x=!0,n.togglePlaybackOnMultipleInstances&&ap_mediaArr.length>1){var e,t=ap_mediaArr.length;for(e=0;e<t;e++)Ge!=ap_mediaArr[e].inst&&ap_mediaArr[e].inst.pauseMedia()}lt||("undefined"!=typeof awpMediaStart&&awpMediaStart(Ge,n.instanceName,W),lt=!0);ae.find(".awp-btn-play").hide(),ae.find(".awp-btn-pause").show(),ne.find(".awp-btn-play").hide(),void ne.find(".awp-btn-pause").show(),st=!0,Oe&&"undefined"!=typeof ga&&ga("send",{hitType:"event",eventCategory:"Audio Waveform Player: "+n.instanceName,eventAction:"played",eventLabel:"title: "+ia(R)+" | time: "+Math.round(Ge.getCurrentTime()),nonInteraction:!0});"undefined"!=typeof awpMediaPlay&&awpMediaPlay(Ge,n.instanceName,M,W)}()})).on("pause",(function(){!function(){ta(),st=!1,Oe&&"undefined"!=typeof ga&&ga("send",{hitType:"event",eventCategory:"Audio Waveform Player: "+n.instanceName,eventAction:"paused",eventLabel:"title: "+ia(R)+" | time: "+Math.round(Ge.getCurrentTime()),nonInteraction:!0});"undefined"!=typeof awpMediaPause&&awpMediaPause(Ge,n.instanceName,M,W)}()})).on("seeking",(function(){var e=y.currentTime,t=y.duration;ke.width(we.width()*(e/t))})).on("timeupdate",(function(){if(!w){var e=y.currentTime,t=y.duration;je&&(ee.html(AWPUtils.formatTime(e)),te.html(AWPUtils.formatTime(t))),ke.width(we.width()*(e/t)),R.end&&e>=R.end&&Jt()}})).on("error",(function(e){R.origtype&&"soundcloud"==R.origtype?(y.currentTime&&(n.resumeTime=y.currentTime),p.resume()):("s3_bucket_audio"==R.origtype||"s3_audio"==R.origtype)&&y.error&&y.error.message&&y.error.message.indexOf("PIPELINE_ERROR_READ")>-1?(y.currentTime&&(n.resumeTime=y.currentTime),function(e){-1!=e.key.indexOf(Ye)&&(e.key=AWPUtils.b64DecodeUnicode(e.key.substr(6)));if(n.useCloudfront)var a=n.sourcePath+"includes/aws/aws2.php";else a=n.sourcePath+"includes/aws/aws.php";var i={object_key:e.key,bucket:e.bucket,action:"get_url",region:n.s3Region,expire:n.s3UrlExpireTime,cf_expire:n.cf_expire,cred:n.s3,upload_dir:n.upload_dir};t.ajax({type:"GET",url:a,data:i,dataType:"json"}).done((function(e){y.src=e;var t=y.play();void 0!==t&&t.then((function(){})).catch((function(e){}))})).fail((function(e,t,a){console.log(e,t,a),n.autoAdvanceToNextSongOnError&&Ge.nextMedia()}))}(R)):("undefined"!=typeof awpMediaError&&awpMediaError(Ge,n.instanceName,W),n.autoAdvanceToNextSongOnError&&Ge.nextMedia())})),y.src=_,Se){var e=y.play();void 0!==e&&e.then((function(){})).catch((function(e){}))}}function jt(e){if(He){if(!w){if("touchstart"==e.type){var t=e.originalEvent.touches;if(!(t&&t.length>0))return!1;t[0]}else e,e.preventDefault();w=!0,ze.on(Ke.moveEvent,(function(e){!function(e){var t;if("touchmove"==e.type){var a;if(e.originalEvent.touches&&e.originalEvent.touches.length)a=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;a=e.originalEvent.changedTouches}if(a.length>1)return!1;t=a[0],e.preventDefault()}else t=e,e.preventDefault();qt(t),It(t)}(e)})).on(Ke.upEvent,(function(e){!function(e){if(w){var t;if(w=!1,ze.off(Ke.moveEvent).off(Ke.upEvent),"touchend"==e.type){var a;if(e.originalEvent.touches&&e.originalEvent.touches.length)a=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;a=e.originalEvent.changedTouches}if(a.length>1)return!1;t=a[0],e.preventDefault()}else t=e,e.preventDefault();qt(t,!0),Te&&X.hide()}}(e)}))}return!1}}function qt(e,t,a){var n=e.pageX-ye.offset().left,i=ye.width();n<0?n=0:n>i&&(n=i);var o,r,l=Math.max(0,Math.min(1,n/i));if(y&&!isNaN(y.duration)){(o=l*(r=y.duration))>r-2&&(o=r-2);try{y.currentTime=o}catch(e){console.log(e)}}ke.width(l*i)}function Bt(e){var a=[{name:"action",value:"awp_read_peaks"},{name:"id",value:e},{name:"path",value:R.peakdir||null}];m=t.ajax({url:n.sourcePath+"peaks/peaks.php",type:"post",data:a,dataType:"json"}).done((function(e){e.length?(d.backend.peaks=e,c=!0,n.drawWaveWithoutLoad?d.drawBuffer():d.load(_,d.backend.peaks)):(u=!0,R.remote?(ve.css("opacity",1).html("Loading waveform..."),function(){var e=[{name:"id",value:_},{name:"title",value:R.title},{name:"path",value:R.peakdir||null}];f=t.ajax({url:n.sourcePath+"peaks/remote_dl.php",type:"post",data:e,dataType:"json"}).done((function(e){d.getArrayBuffer(e),d.load(e)})).fail((function(e,t,a){console.log(e,t,a)}))}()):d.load(_))})).fail((function(e,t,a){console.log(e,t,a)}))}function Ht(){if(!1,R.origtype&&"soundcloud"==R.origtype){if(!R.sc_url)return void p.get_stream_url(R.sc_data.id);_=R.sc_url,delete R.sc_url}else if(Ie&&R.wav)_=R.wav;else if(Ee&&R.aac)_=R.aac;else if(Ae&&R.mp3)_=R.mp3;else if(R.flac)_=R.flac;else{if(!R.path)return void alert("No required audio format supplied! Please add mp3 audio format to play!");_=R.path}if(-1!=_.indexOf(Ye)&&(_=atob(_.substr(6))),n.useImageWaveform)if(R.peakImage){var e=R.peakImage.load;AWPUtils.relativePath(e)||(e=AWPUtils.qualifyURL(e));var t=R.peakImage.progress;AWPUtils.relativePath(t)||(t=AWPUtils.qualifyURL(t)),be.css("backgroundImage","url("+e+")"),Pe.css("backgroundImage","url("+t+")"),we.css("display","block"),Pe.width(we.width()),we.removeClass("awp-hidden").addClass("awp-visible"),ea()}else console.log("No waveform image provided!");else R.peakData?(d.backend.peaks=R.peakData,c=!0,n.drawWaveWithoutLoad?d.drawBuffer():d.load(_,d.backend.peaks)):Bt(R.peakName||R.title);Lt()}function Ft(e){Fe=!0,na(),rt&&Zt(),"#"!=e.charAt(0)&&(e="#"+e);var a,i,o=q.find(e);if(0==o.length)return alert('Failed to select playlist! Check activePlaylist option in settings. Make sure that element: "'+e+'" exist in awp-playlist-list!'),aa(),Fe=!1,!1;n.activePlaylist=e,"undefined"!=typeof awpPlaylistStartLoad&&awpPlaylistStartLoad(Ge,n.instanceName),Qe={},o.attr("data-thumb")&&(Qe.thumb=o.attr("data-thumb")),o.attr("data-playback-rate")&&(Qe.playbackRate=o.attr("data-playback-rate")),o.attr("data-start")&&(Qe.start=o.attr("data-start")),o.attr("data-end")&&(Qe.end=o.attr("data-end")),o.find(".awp-playlist-item").each((function(){i=t(this),a=Gt(i),nt.push(a)})),it=nt.length,Vt()}function Gt(e){var t={};return t.origclasses=e.attr("class"),t.type=t.origtype=e.attr("data-type"),-1!=Je.indexOf(t.type)&&(t.pi_item=e),null!=e.attr("data-media-id")&&(t.mediaId=e.attr("data-media-id")),null!=e.attr("data-bucket")&&(t.bucket=e.attr("data-bucket"),-1!=t.bucket.indexOf(Ye)&&(t.bucket=AWPUtils.b64DecodeUnicode(t.bucket.substr(6)))),null!=e.attr("data-key")&&(t.key=e.attr("data-key"),-1!=t.key.indexOf(Ye)&&(t.key=AWPUtils.b64DecodeUnicode(t.key.substr(6)))),null!=e.attr("data-mp3")?t.path=e.attr("data-mp3"):null!=e.attr("data-wav")?t.path=e.attr("data-wav"):null!=e.attr("data-aac")?t.path=e.attr("data-aac"):null!=e.attr("data-path")&&(t.path=e.attr("data-path")),t.path&&-1!=t.path.indexOf(Ye)&&(t.path=atob(t.path.substr(6))),null!=e.attr("data-peak-load")&&null!=e.attr("data-peak-progress")&&(t.peakImage={load:e.attr("data-peak-load"),progress:e.attr("data-peak-progress")}),null!=e.attr("data-peak-array")&&(t.peakData=e.attr("data-peak-array").split(",")),null!=e.attr("data-peak-name")&&(t.peakName=e.attr("data-peak-name")),null!=e.attr("data-limit")&&(t.limit=Math.abs(parseInt(e.attr("data-limit"),10))),null!=e.attr("data-thumb")?t.thumb=e.attr("data-thumb"):null!=e.attr("data-thumb-default")&&(t.thumbDefault=e.attr("data-thumb-default")),null!=e.attr("data-title")&&(t.title=e.attr("data-title")),null!=e.attr("data-artist")&&(t.artist=e.attr("data-artist")),null!=e.attr("data-album")&&(t.album=e.attr("data-album")),null!=e.attr("data-description")&&(t.description=e.attr("data-description")),null!=e.attr("data-download")&&(t.download=e.attr("data-download")),null!=e.attr("data-id3")&&(t.id3=!0),null!=e.attr("data-dir-url")&&(t.dirurl=e.attr("data-dir-url")),null!=e.attr("data-peak-dir")&&(t.peakdir=e.attr("data-peak-dir")),Qe.start?t.start=Qe.start:null!=e.attr("data-start")&&(t.start=Math.abs(e.attr("data-start"))),Qe.end?t.end=Qe.end:null!=e.attr("data-end")&&(t.end=Math.abs(e.attr("data-end"))),null!=e.attr("data-duration")&&(t.duration=Math.abs(e.attr("data-duration"))),Qe.playbackRate?t.playbackRate=Qe.playbackRate:null!=e.attr("data-playback-rate")?t.playbackRate=Math.abs(e.attr("data-playback-rate")):t.playbackRate=1,null!=e.attr("data-link")&&(t.link=e.attr("data-link"),t.target="_blank",null!=e.attr("data-target")&&(t.target=e.attr("data-target")),null!=e.attr("data-rel")&&(t.rel=e.attr("data-rel"))),null!=e.attr("data-duration")&&(t.duration=e.attr("data-duration")),null!=e.attr("data-remote")&&(t.remote=!0),null!=e.attr("data-sort")&&(t.sort=e.attr("data-sort")),null!=e.attr("data-playlist-icons")&&(t.playlistIcons=e.data("playlist-icons")),t}function Vt(){if(++et>it-1)Xt();else{var e=nt[et],a=nt[et].type;RegExp("^audio$").test(a)?(at.push(e),Vt()):"podcast"==a?function(e){if("file:"==window.location.protocol)return void console.log("Using Podcast requires server connection!");S=e.limit?e.limit:999999999;var a=Ze+"?url="+encodeURIComponent(e.path),i=S;t.ajax({url:a,dataType:"json",cache:!1}).done((function(a){var o,r,l,s=a.contents.substr(a.contents.indexOf("<?xml")),d=AWPUtils.parseXML(s),u=0;t(d).find("image").length&&t(d).find("image").attr("href")?l=t(d).find("image").attr("href"):t(s).find("itunes\\:image").length&&t(s).find("itunes\\:image").attr("href")&&(l=t(s).find("itunes\\:image").attr("href")),l&&l.lastIndexOf("&size=Large")&&(l=l.replace("=Large","=Small")),t(d).find("item").each((function(){if(u>=i)return!1;if(o=t(this),(r=t.extend(!0,{},e)).type="audio",r.mp3=o.find("enclosure").attr("url"),!r.title&&o.find("title").length&&(r.title=o.find("title").text()),r.artist||(o.find("author").length?r.artist=o.find("author").text():o.find("itunes\\:author").length&&(r.artist=o.find("itunes\\:author").text())),o.find("pubDate").length&&(r.date=o.find("pubDate").text()),!r.description&&o.find("description").length){var a=o.find("description").text(),s=document.createElement("div");s.innerHTML=a,r.description=s.textContent||s.innerText||""}r.duration||(o.find("itunes\\:duration").length?r.duration=o.find("itunes\\:duration").text():o.find("duration").length&&(r.duration=o.find("duration").text())),r.thumb||(o.find("image").length&&o.find("image").attr("href")?r.thumb=o.find("image").attr("href"):o.find("itunes\\:image").length&&o.find("itunes\\:image").attr("href")?r.thumb=o.find("itunes\\:image").attr("href"):l&&(r.thumb=l)),r.thumb.lastIndexOf("&size=Large")&&(r.thumb=r.thumb.replace("=Large","=Small")),n.createDownloadIconsInPlaylist&&(r.download||(r.download=r.mp3)),o.find("link").length&&(r.link||n.createLinkIconsInPlaylist&&(r.link=o.find("link").text())),at.push(r),u++})),Vt()})).fail((function(e,t,a){console.log(e,t,a),checkSound()}))}(e):"soundcloud"==a?([],p||(p=new AWPSCLoader({settings:n}),t(p).on("AWPSCLoader.END_LOAD",(function(e,t){var a,n,i=t.data.length;for(a=0;a<i;a++)n=t.data[a],at.push(n);Xt()})),t(p).on("AWPSCLoader.GET_STREAM_URL",(function(e,t){R.sc_url=t,Ht()}))),p.request(e,1e4)):RegExp("^folder$").test(a)?function(e){if("file:"==window.location.protocol)return console.log("Reading files from folders locally is not possible! This requires online server connection."),Vt(),!1;var a=e.path.replace(/\/\//g,"/"),i=n.sourcePath+"includes/folder_parser.php",o={dir:a,limit:e.limit||1e4};e.id3&&(L=N=at.length-1);t.ajax({type:"GET",url:i,data:o,dataType:"json"}).done((function(a){e.sort&&("filename-asc"==e.sort?AWPUtils.keysrt(a,"filename"):"filename-desc"==e.sort?AWPUtils.keysrt(a,"filename",!0):"date-asc"==e.sort?AWPUtils.keysrt(a,"filemtime"):"date-desc"==e.sort&&AWPUtils.keysrt(a,"filemtime",!0));var i,o,r,l,s=a.length;for(i=0;i<s;i++)o=a[i],(r=t.extend(!0,{},e)).type="audio",l=r.dirurl?r.dirurl+o.basename:o.fullpath,r[o.extension]=l,r.title||(r.title=o.filename),n.createDownloadIconsInPlaylist&&(r.download||(r.download=l)),r.share||(r.share=l),n.createLinkIconsInPlaylist&&(r.link||(r.link=l)),at.push(r),N++;e.id3?zt():Vt()})).fail((function(e,t,a){console.log("Error processing folder: "+e.responseText),Vt()}))}(e):RegExp("^gdrive_folder$").test(a)||RegExp("^gdrive-folder$").test(a)?function(e){if("file:"==window.location.protocol)return console.log("Reading files from folders locally is not possible! This requires online server connection."),Vt(),!1;var a=n.gDriveAppId||n.gdk;if(AWPUtils.isEmpty(a))return console.log("Google Drive api key has not been set in settings!"),Vt(),!1;var i="https://www.googleapis.com/drive/v3/files?q='"+e.path+"'+in+parents&pageSize=1000&key="+a;t.ajax({url:i,dataType:"jsonp"}).done((function(a){var i,o,r,l=a.files.length,s=[],d=[];for(i=0;i<l;i++)o=a.files[i],/mp3|mpeg|mpeg3|wav|aac|adts/.test(o.mimeType)?(d.push(o),AWPUtils.keysrt(d,"name")):/jpg|jpeg|png/.test(o.mimeType)&&(s.push(o),AWPUtils.keysrt(s,"name"));for(e.sort&&("filename-asc"==e.sort?(AWPUtils.keysrt(d,"name"),AWPUtils.keysrt(s,"name")):"filename-desc"==e.sort&&(AWPUtils.keysrt(d,"name",!0),AWPUtils.keysrt(s,"name",!0))),l=d.length,i=0;i<l;i++){o=d[i],(r=t.extend(!0,{},e)).type="audio",r[o.name.substr(o.name.lastIndexOf(".")+1).toLowerCase()]="https://drive.google.com/uc?export=view&id="+o.id,s.length&&!r.thumb&&s[i]&&(r.thumb="https://drive.google.com/uc?export=view&id="+s[i].id),r.title||(r.title=o.name.substr(0,o.name.lastIndexOf("."))),n.createDownloadIconsInPlaylist&&(r.download||(r.download="https://drive.google.com/uc?export=download&id="+o.id)),r.share||(r.share="https://drive.google.com/open?id="+o.id),n.createLinkIconsInPlaylist&&(r.link||(r.link="https://drive.google.com/open?id="+o.id)),at.push(r)}Vt()})).fail((function(e,t,a){console.log("Error processing gdrive folder: "+e.responseText),Vt()}))}(e):RegExp("^onedrive_folder$").test(a)||RegExp("^onedrive-folder$").test(a)?function(e){if("file:"==window.location.protocol)return console.log("Reading files from folders locally is not possible! This requires server connection."),!1;var a=e.path;a.indexOf("?")>-1&&(a=a.substr(0,a.indexOf("?")));var i="https://api.onedrive.com/v1.0/shares/u!"+btoa(a)+"/root?expand=children";t.ajax({url:i,dataType:"json"}).done((function(a){var i,o,r,l=a,s=l.children.length,d=[],u=[];for(i=0;i<s;i++)if((o=l.children[i]).file)if(/audio/.test(o.file.mimeType)?u.push(o):/image/.test(o.file.mimeType)&&d.push(o),"date-asc"==e.sort||"date-desc"==e.sort){var c=new Date(o.fileSystemInfo.lastModifiedDateTime);o.fileSystemInfo.lastModifiedDateTime=c.getTime()}else if("created-date-asc"==e.sort||"created-date-desc"==e.sort){c=new Date(o.fileSystemInfo.createdDateTime);o.fileSystemInfo.createdDateTime=c.getTime()}for(e.sort&&("filename-asc"==e.sort?(AWPUtils.keysrt(u,"name"),d.length&&AWPUtils.keysrt(d,"name")):"filename-desc"==e.sort?(AWPUtils.keysrt(u,"name",!0),d.length&&AWPUtils.keysrt(d,"name",!0)):"date-asc"==e.sort?(AWPUtils.keysrt2(u,"fileSystemInfo","lastModifiedDateTime"),d.length&&AWPUtils.keysrt2(d,"fileSystemInfo","lastModifiedDateTime")):"date-desc"==e.sort?(AWPUtils.keysrt2(u,"fileSystemInfo","lastModifiedDateTime",!0),d.length&&AWPUtils.keysrt2(d,"fileSystemInfo","lastModifiedDateTime",!0)):"created-date-asc"==e.sort?(AWPUtils.keysrt2(u,"fileSystemInfo","createdDateTime"),d.length&&AWPUtils.keysrt2(d,"fileSystemInfo","createdDateTime")):"created-date-desc"==e.sort&&(AWPUtils.keysrt2(u,"fileSystemInfo","createdDateTime",!0),d.length&&AWPUtils.keysrt2(d,"fileSystemInfo","createdDateTime",!0))),s=u.length,i=0;i<s;i++)o=u[i],(r=t.extend(!0,{},e)).type="audio",o.audio&&(o.audio.title&&(r.title=o.audio.title),o.audio.artist&&(r.artist=o.audio.artist),o.audio.duration&&(r.duration=o.audio.duration/1e3),o.audio.genre&&(r.genre=o.audio.genre),o.audio.album&&(r.album=o.audio.album),o.audio.bitrate&&(r.bitrate=o.audio.bitrate)),r.title||(r.title=o.name.substr(0,o.name.lastIndexOf("."))),r.path=o["@content.downloadUrl"],n.createDownloadIconsInPlaylist&&(r.download||(r.download=r.path)),n.createLinkIconsInPlaylist&&(r.link||(r.link=o.webUrl)),!r.thumb&&d[i]&&(r.thumb=d[i]["@content.downloadUrl"]),at.push(r);Vt()})).fail((function(e,t,a){console.log("Error processOnedriveFolder: "+e,t,a),Vt()}))}(e):"json"==a?function(e){t.ajax({type:"GET",url:e.path,dataType:"json"}).done((function(e){var t,a=(at=e).length;for(t=0;t<a;t++)at[t].peakData&&(at[t].peakData=at[t].peakData.split(","));Vt()})).fail((function(e,t,a){console.log("Error processJson: "+e,t,a),Vt()}))}(e):"s3_audio"==a?(at.push(e),Vt()):"s3_bucket_audio"==a?function(e){if("file:"==window.location.protocol)return console.log("Reading folders requires server connection."),!1;var a=n.sourcePath+"includes/aws/aws.php",i={bucket:e.bucket,region:n.s3Region,action:"list_bucket",cred:n.s3};t.ajax({type:"GET",url:a,data:i,dataType:"json"}).done((function(a){var i,o,r,l=a.length;for(e.sort&&("filename-asc"==e.sort?AWPUtils.keysrt(a,"filename"):"filename-desc"==e.sort&&AWPUtils.keysrt(a,"filename",!0)),i=0;i<l;i++)o=a[i],/mp3|wav|aac|ogg|flac/.test(o)&&((r=t.extend(!0,{},e)).type="s3_audio",r.key=o,r.title=o.substr(0,o.lastIndexOf(".")),r.thumb_key=r.title+"."+n.s3ThumbExtension,at.push(r));Vt()})).fail((function(e,t,a){console.log("Error processS3Bucket: "+e.responseText,t,a),Vt()}))}(e):(console.log("Wrong data-type in playlist! Type = "+a),Vt())}}function zt(){var e=at[N],t=e.mp3||e.wav||e.aac;jsmediatags.read(t,{onSuccess:function(t){var a=t.tags,n=a.picture;if(a.artist&&(e.artist=a.artist),a.title&&(e.title=a.title),a.album&&(e.album=a.album),n){var i,o="",r=n.data.length;for(i=0;i<r;i++)o+=String.fromCharCode(n.data[i]);e.thumb="data:"+n.format+";base64,"+window.btoa(o)}--N>L?zt():Vt()},onError:function(e){console.log("ID3 error: ",e.type,e.info),--N>L?zt():Vt()}})}function Xt(){var e,a,i,o,r,l,s,d,u=P?k:tt.length,c=at.length,p=0;for(a=0;a<c;a++){if(e=a+u,P&&p++,i=(l=at[a]).type,Ne){if(-1!=Je.indexOf(l.origtype)?o=l.pi_item.clone():(l.origclasses||(l.origclasses="awp-playlist-item"),o=t('<div class="'+l.origclasses+'"/>'),delete l.origclasses),r=t('<div class="awp-playlist-item-content"></div>').on("click",Mt).prependTo(o),Te||r.on("mouseenter",Ut).on("mouseleave",_t),null!=typeof l.mediaId&&o.attr("data-media-id",l.mediaId),-1!=_e.indexOf("thumb")){var f=l.thumb||l.thumbDefault;if(f){var m=new Image;m.className="awp-hidden",m.onload=function(){this.className="awp-visible awp-thumbimg"},m.src=f,t('<span class="awp-playlist-thumb"></span>').append(m).appendTo(r)}}if(-1!=_e.indexOf("title")&&t('<span class="awp-playlist-title"></span>').appendTo(r),d=t('<div class="awp-playlist-icons"/>').insertAfter(r),l.link){var h=l.target||"_blank",g=l.rel||"nofollow",y=t('<a class="awp-link awp-playlist-icon" href="'+l.link+'" target="'+h+'" rel="'+g+'" data-tooltip="'+n.linkIconTooltip+'">'+n.iconLink+"</a>");d.append(y)}if(l.download){if(Xe)var v=t('<a class="awp-download awp-playlist-icon" href="'+l.download+'" download data-tooltip="'+n.downloadIconTooltip+'">'+n.iconDownload+"</a>");else v=t('<a class="awp-download awp-playlist-icon" href="#" data-tooltip="'+n.downloadIconTooltip+'">'+n.iconDownload+"</a>");d.append(v)}if(l.playlistIcons){var w,I=l.playlistIcons.length;for(u=0;u<I;u++){var E='<a class="awp-playlist-icon awp-icon-'+(w=l.playlistIcons[u]).icon+'" href="'+w.url+'" target="'+w.target+'" rel="'+w.rel+'" data-tooltip="'+w.title+'">&#x'+w.icon+"</a>";d.append(E)}}P?(s?s.after(o):b?o.appendTo(F):F.children("div").eq(k).before(o),s=o):o.appendTo(F)}tt.splice(e,0,{id:e,type:i,data:l})}if(rt=F,Yt(),P||A){var x=W;mt.setPlaylistItems(it,!1),k<=x&&(b||mt.reSetCounter(x+p)),T&&mt.setCounter(k,!1)}else mt.setPlaylistItems(it);Kt(),ot=!0,"undefined"!=typeof awpPlaylistEndLoad&&awpPlaylistEndLoad(Ge,n.instanceName,F)}function Yt(){if(it=tt.length,Ne){var e,a,i,o=0;F.find(".awp-playlist-item").each((function(){a=t(this).attr("data-id",o),(i=a.find(".awp-playlist-title")).length&&(e=function(e){var t=tt[e].data,a="";void 0===t.artist||AWPUtils.isEmpty(t.artist)||void 0===t.title||AWPUtils.isEmpty(t.title)?void 0!==t.artist||void 0===t.title||AWPUtils.isEmpty(t.title)?void 0===t.artist||AWPUtils.isEmpty(t.artist)||void 0!==t.title||(a=t.artist):a=t.title:a=t.artist+n.artistTitleSeparator+t.title;return a}(o),n.useNumbersInPlaylist?i.html(AWPUtils.counter(o)+n.numberTitleSeparator+e):i.html(e)),tt[o].id=o,o++}))}}function Kt(){if(A=!1,P=!1,aa(),Fe=!1,He||(He=!0,la(),Ne&&!O&&n.usePlaylistScroll&&function(){if("mcustomscrollbar"==n.playlistScrollType){var e="horizontal"==n.playlistScrollOrientation?"x":"y";H.mCustomScrollbar({axis:e,theme:n.playlistScrollTheme,scrollInertia:0,mouseWheel:{normalizeDelta:!0,deltaFactor:50,preventDefault:!0},keyboard:{enable:!1},advanced:{autoExpandHorizontalScroll:!0}})}else E=new PerfectScrollbar(H[0],{wheelSpeed:2,wheelPropagation:!0,minScrollbarLength:30});O=!0}(),Tt(n.volume),AWPUtils.isEmpty(Be)||Ge.sort(Be),Y.hasClass("awp-is-sticky")&&function(){Y.removeClass("awp-is-sticky");var e=Y.height();n.stickyPlayerOpened?Y.css("bottom","0px"):Y.css("bottom",-e+"px"),ut(),setTimeout((function(){Y.css("opacity",1)}),50)}(),null!=typeof awpSetupDone&&awpSetupDone(Ge,n.instanceName)),!P&&it>0){var e=n.activeItem;e>it-1&&(e=it-1),e>-1&&mt.setCounter(e,!1)}}function Jt(){console.log("mediaEndHandler"),"undefined"!=typeof awpMediaEnd&&awpMediaEnd(Ge,n.instanceName,W),Oe&&"undefined"!=typeof ga&&ga("send",{hitType:"event",eventCategory:"Audio Waveform Player: "+n.instanceName,eventAction:"ended",eventLabel:"title: "+ia(R),nonInteraction:!0});var e=R.start||0;"next"==n.mediaEndAction?Ge.nextMedia():"loop"==n.mediaEndAction?d.play(Number(e)):"rewind"==n.mediaEndAction?(d.pause(),d.seekTo(e/d.getDuration())):"stop"==n.mediaEndAction&&d.pause()}function Qt(){He&&void 0!==U&&(M&&Nt(),$t(),mt.reSetCounter())}function $t(){f&&(f.abort(),f=null),m&&(m.abort(),m=null),y&&(y.pause(),y.src=""),g&&g.off("ended canplay canplaythrough loadedmetadata pause play error timeupdate seeking"),void 0!==d&&d.empty(),ve.css("opacity",0),K.removeClass("awp-visible").addClass("awp-hidden"),be.empty(),Pe.empty(),ke.width(0),we.css("display","none").removeClass("awp-visible").addClass("awp-hidden"),je&&(ee.removeClass("awp-visible").addClass("awp-hidden"),te.removeClass("awp-visible").addClass("awp-hidden"),ee.html("0:00"),te.html("0:00")),J.empty(),ta(),U=null,st=!1,lt=!1,T=!1,"undefined"!=typeof awpCleanMedia&&awpCleanMedia(Ge,n.instanceName)}function Zt(){U&&$t(),Ne&&rt.find(".awp-playlist-item").remove(),rt=null,P=!1,!1,ot=!1,it=0,et=-1,tt=[],at=[],nt=[],mt.reSetCounter(),Be="",da(),"undefined"!=typeof awpDestroyPlaylist&&awpDestroyPlaylist(Ge,n.instanceName,F)}function ea(){ee.removeClass("awp-hidden").addClass("awp-visible"),te.removeClass("awp-hidden").addClass("awp-visible")}function ta(){ae.find(".awp-btn-play").show(),ae.find(".awp-btn-pause").hide(),ne.find(".awp-btn-play").show(),ne.find(".awp-btn-pause").hide()}function aa(){z.css("display","none")}function na(){z.css("display","block")}function ia(e){var t="";return void 0===e.artist||AWPUtils.isEmpty(e.artist)||void 0===e.title||AWPUtils.isEmpty(e.title)?void 0!==e.artist||void 0===e.title||AWPUtils.isEmpty(e.title)?void 0===e.artist||AWPUtils.isEmpty(e.artist)||void 0!==e.title||(t=e.artist):t=e.title:t=e.artist+n.artistTitleSeparator+e.title,t}function oa(){var e,a,i,o=R.playbackRate;if(h&&h.setVisual(o),Q.length&&$.length)R.title&&Q.html(R.title),R.artist&&$.html(R.artist);else if(Q.length){var r=ia(R);Q.html(r)}if(R.description?Z.html(R.description):Z.html(""),!R.thumb&&("s3_bucket_audio"==R.origtype||"s3_audio"==R.origtype)&&n.getThumbFromBucket){if(!R.thumb_key){var l=R.key.substr(0,R.key.lastIndexOf("."));R.thumb_key=l+"."+n.s3ThumbExtension}return e=R,a=n.sourcePath+"includes/aws/aws.php",i={object_key:e.thumb_key,bucket:e.bucket,action:"get_url_thumb",region:n.s3Region,expire:n.s3UrlExpireTime,cred:n.s3},void t.ajax({type:"GET",url:a,data:i,dataType:"json"}).done((function(e){R.thumb=e,ra()})).fail((function(e,t,a){console.log(e,t,a)}))}ra()}function ra(){var e=R.thumb||R.thumbDefault||Qe.thumb;if(e&&("soundcloud"==R.origtype&&n.soundCloudThumbQuality&&(e=e.replace("large.jpg",n.soundCloudThumbQuality)),J.length)){var t=new Image;t.className="awp-hidden",t.onload=function(){this.className="awp-visible"},t.src=e,J[0].appendChild(t)}}function la(){if(n.breakPointArr){var e,t,a=n.breakPointArr.length,i=j.width();for(e=0;e<a;e++)i<(t=n.breakPointArr[e])?j.addClass("awp-breakpoint-"+t.toString()):j.removeClass("awp-breakpoint-"+t.toString())}d&&(d.drawer.containerWidth=d.drawer.container.clientWidth,d.drawBuffer(),st||d.drawer.updateProgress(d.backend.getPlayedPercents())),F.hasClass("awp-masonry")&&Ge.masonry&&Ge.masonry.masonry("layout")}function sa(e){var a,n,i,o=t(e);return a=t("<div>").append(o.clone()).html(),(n=document.createElement("div")).innerHTML=a,i=n.firstChild,t(i)}function da(){V.find(".awp-btn").hide(),Be?V.find(".awp-sort-alpha-desc").show():V.find(".awp-sort-alpha-asc").show()}function ua(){oe.find(".awp-btn").hide(),Me?oe.find(".awp-btn-looping-on").show():oe.find(".awp-btn-looping-off").show()}function ca(){le.find(".awp-btn").hide(),Ue?le.find(".awp-btn-random-on").show():le.find(".awp-btn-random-off").show()}if("image"==n.iconType&&j.on("mouseenter",".awp-contr-btn, .awp-playlist-icon",(function(){var e=t(this);if(null!=e.find("img:visible").attr("data-icon-hover")){var a=e.find("img:visible");a.attr("data-icon-normal",a.attr("src")),a.attr("src",a.attr("data-icon-hover"))}})).on("mouseleave",".awp-contr-btn, .awp-playlist-icon",(function(){var e=t(this);if(null!=e.find("img:visible").attr("data-icon-hover")){var a=e.find("img:visible");a.attr("src",a.attr("data-icon-normal"))}})),n.useImageWaveform&&(K.remove(),ve.remove()),g=t(document.createElement("audio")).attr("preload",n.preload),y=g[0],n.allowSeeking&&ye.on(Ke.downEvent,(function(e){return!n.disableSeekbar&&(!n.disableSongSkip&&(!!U&&(jt(e),!1)))})),n.useImageWaveform||((d=WaveSurfer.create({container:K[0],backend:"MediaElement",/*!important*/
interact:!1,pixelRatio:1,hideScrollbar:!0,waveColor:n.wavesurfer.waveColor,progressColor:n.wavesurfer.progressColor,barWidth:n.wavesurfer.barWidth,barRadius:n.wavesurfer.barRadius,barGap:n.wavesurfer.barGap,cursorColor:n.wavesurfer.cursorColor,cursorWidth:n.wavesurfer.cursorWidth,height:n.wavesurfer.height})).on("loading",(function(e){var t=n.waveformLoaderText+" "+e.toString()+"%";ve.css("opacity",1).html(t)})),d.on("error",(function(e){"undefined"!=typeof awpMediaError&&awpMediaError(Ge,n.instanceName,W),n.autoAdvanceToNextSongOnError&&Ge.nextMedia()})),d.on("ready",(function(){K.find("audio").remove(),n.useImageWaveform||(ke=K.find("wave").eq(1))})),d.on("waveform-ready",(function(){u&&(d.exportPCM(n.pcmLength,n.pcmAccuracy,!0).then((function(e){var a,i,o;Array.isArray(e)?e=e.toString():("["==e.charAt(0)&&(e=e.substr(1)),"]"==e.charAt(e.length-1)&&(e=e.substr(0,e.length-1))),a=e,i=R.peakName||R.title,o=[{name:"action",value:"awp_write_peaks"},{name:"peaks",value:a},{name:"id",value:i},{name:"path",value:R.peakdir||null}],t.ajax({url:n.sourcePath+"peaks/peaks.php",type:"post",data:o,dataType:"json"}).done((function(e){})).fail((function(e,t,a){console.log(e.responseText)}))})),u=!1);ve.css("opacity",0),n.useImageWaveform||K.removeClass("awp-hidden").addClass("awp-visible"),ea()})),d.on("redraw",(function(){c&&(ve.css("opacity",0),n.useImageWaveform||K.removeClass("awp-hidden").addClass("awp-visible"),ea(),c=!1)}))),Ve.resize((function(){if(!He)return!1;if(s&&clearTimeout(s),s=setTimeout(la,150),n.useImageWaveform&&Pe.width(we.width()),y){var e=y.currentTime,t=y.duration;ke.width(we.width()*(e/t))}})),this.loadPlayMedia=function(){return!!He&&(!!U&&(!!R&&void(_&&d.backend.peaks&&d.load(_,d.backend.peaks,!0))))},this.playMedia=function(){if(!He)return!1;if(!U)return!1;if(st)return!1;if(y){var e=y.play();void 0!==e&&e.then((function(){})).catch((function(e){}))}},this.pauseMedia=function(){return!!He&&(!!U&&(!!st&&void(y&&y.pause())))},this.checkMedia=function(e){if(!He)return!1;if(!U)return!1;var t=e.toLowerCase();st&&"pause"==t&&y&&y.pause()},this.togglePlayback=function(){if(!He)return!1;if(!U)return!1;if(y)if(y.paused){var e=y.play();void 0!==e&&e.then((function(){})).catch((function(e){}))}else y.pause()},this.stop=function(){return!!He&&(!!U&&void(y&&y.pause()))},this.nextMedia=function(){if(!He)return!1;if(!rt)return!1;if(n.disableSongSkip)return!1;if(n.usePlaylist&&I){var e=F.find(".awp-playlist-item-selected").nextAll(".awp-playlist-item:not(.awp-filter-hidden)").filter(":first");if(e.length){var t=e.attr("data-id");mt.setCounter(t,!1)}else mt.advanceHandler(1,!0)}else mt.advanceHandler(1,!0)},this.previousMedia=function(){return!!He&&(!!rt&&(!n.disableSongSkip&&void mt.advanceHandler(-1,!0)))},this.loadMedia=function(e,t){if(!He)return!1;if(Fe)return!1;if(!rt)return!1;if("title"==e){var a,n;for(a=0;a<it;a++)if(t==tt[a].data.title){t=a,n=!0;break}if(!n)return alert('Track with title "'+t+'" doesnt exist. LoadMedia failed.'),!1}else if("counter"==e){if(t<0)return alert('Invalid track number. Track number  "'+t+'" doesnt exist. LoadMedia failed.'),!1;if(t>it-1)return alert('Invalid track number. Track number  "'+t+'" doesnt exist. LoadMedia failed.'),!1}else if("id"==e){var i=F.find(".awp-playlist-item[data-media-id="+t+"]");if(null==(t=F.children(".awp-playlist-item").index(i))||!t||-1==t)return alert("No media with ID to load! LoadMedia failed."),!1}mt.processPlaylistRequest(t)},this.loadPlaylist=function(e){return!!He&&(!Fe&&(void 0===e||AWPUtils.isEmpty(e)?(alert("loadPlaylist method requires id parameter. loadPlaylist failed."),!1):n.activePlaylist!=e&&void Ft(e)))},this.addTrack=function(e,t,a,n){if(!He||Fe)return!1;if(void 0===e)return alert("addTrack method requires format parameter. AddTrack failed."),!1;if(void 0===t)return alert("addTrack method requires track parameter. AddTrack failed."),!1;T=!1,void 0!==a&&(T=a);var i,o,r,l=1,s=!1;if("string"==typeof t||"[object Object]"===Object.prototype.toString.call(t));else{if("[object Array]"!==Object.prototype.toString.call(t))return alert("addTrack method requires track as string, object or array parameter. AddTrack failed."),!1;l=t.length,s=!0}if(k=n,b=!1,P=!0,rt)if(void 0!==k){if(k<0)return alert('Invalid position to insert track to. Position number "'+n+'" doesnt exist. AddTrack failed.'),!1;if(k>it)return alert('Invalid position to insert track to. Position number "'+n+'" doesnt exist. AddTrack failed.'),!1;k==it&&(b=!0)}else b=!0,k=it;else{if(void 0!==k){if(0!=k)return alert('Invalid position to insert track to. Position number "'+n+'" doesnt exist. AddTrack failed.'),!1}else k=0;b=!0}for(Fe=!0,na(),ot=!1,A=!0,et=-1,at=[],nt=[],i=0;i<l;i++)o=s?t[i]:t,r={},r="html"==e?Gt(sa(o)):o,nt.push(r);it=nt.length,!1,rt||!0,rt=F,Vt()},this.inputAudio=function(e){return!!He&&(!Fe&&(void 0===e?(alert("inputAudio method requires data parameter. inputAudio failed."),!1):(M&&Nt(),it>0&&mt.reSetCounter(),R=e,U=e.type,-1==Je.indexOf(U)?(alert("inputAudio method supports tracks that dont require processing: "+Je),!1):(oa(),Re&&(t=R.thumb||R.thumbDefault||Qe.thumb,navigator.mediaSession.metadata=new MediaMetadata({title:R.title,artist:R.artist||"",album:R.album||"",artwork:[{src:t||""}]})),Se=!0,void Ht()))));var t},this.removeTrack=function(e){if(!He||Fe)return!1;if(!rt)return!1;if(void 0===e)return alert("removeTrack method requires id parameter. removeTrack failed."),!1;if("string"==typeof e){var t,a=!1;for(t=0;t<it;t++)if(e==tt[t].data.title){e=t,a=!0;break}if(!a)return alert('Track with title "'+e+'" doesnt exist. RemoveTrack failed.'),!1}else{if("number"!=typeof e)return alert("removeTrack method requires either a id number or a track title to remove. removeTrack failed."),!1;if((e=parseInt(e,10))<0||e>it-1)return alert('Invalid id number. Track number  "'+e+'" doesnt exist. RemoveTrack failed.'),!1}tt[e]?function(e){if(F.children(".awp-playlist-item").eq(e).remove(),tt.splice(e,1),Yt(),it>0){var t=mt.getCounter();e==t?($t(),mt.setPlaylistItems(it)):(mt.setPlaylistItems(it,!1),e<t&&mt.reSetCounter(mt.getCounter()-1))}else Zt()}(e):alert('RemoveTrack with id "'+e+'" failed.')},this.sort=function(e,a){if(!He)return!1;if(!rt)return!1;if(void 0===e)return console.log("Sort method requires type parameter. Sort method failed."),!1;if(Be==o)return!1;var n=F.children(".awp-playlist-item"),i=n.length,o=e.toLowerCase();if(i<2)return!1;if("title-asc"==o){AWPUtils.keysrt2(tt,"data","title");var r=[];for(l=0;l<it;l++)r.push(tt[l].id)}else if("title-desc"==o){AWPUtils.keysrt2(tt,"data","title",!0);var l;r=[];for(l=0;l<it;l++)r.push(tt[l].id)}else{if("random"!=o)return console.log("Sort method requires type parameter. Sort method failed."),!1;r=AWPUtils.randomiseArray(i);tt=AWPUtils.sortArray(tt,r)}Be=o;var s=mt.getCounter();if(F.append(t.map(r,(function(e){return n[e]}))),-1!=s){var d=F.children(".awp-playlist-item[data-id='"+s+"']").index();mt.reSetCounter(d)}Yt()},this.destroyInstance=function(){Zt(),Qt(),void 0!==d&&d.destroy(),n.usePlaylistScroll&&("mcustomscrollbar"==n.playlistScrollType?"undefined"!=typeof mCustomScrollbar&&H.mCustomScrollbar("destroy"):"perfect-scrollbar"==n.playlistScrollType&&E&&(E.destroy(),E=null),O=!1)},this.destroyMedia=function(){if(!He)return!1;Qt()},this.destroyPlaylist=function(){return!!He&&(!!rt&&void Zt())},this.setPlaybackRate=function(e){if(!He)return!1;if(!U)return!1;if(n.playbackRate=e,h&&h.setVisual(e),y)try{y.playbackRate=Number(e)}catch(e){}},this.toggleRandom=function(e){return!!He&&(void 0!==mt&&(Ue=void 0!==e?e:!Ue,mt.setRandom(Ue),void ca()))},this.toggleLoop=function(e){return!!He&&(void 0!==mt&&(Me=void 0!==e?e:!Me,mt.setLooping(Me),void ua()))},this.setVolume=function(e){if(!He)return!1;e<0?e=0:e>1&&(e=1),n.volume=e,Tt()},this.getVolume=function(){return!!He&&n.volume},this.toggleMute=function(){if(!He)return!1;kt()},this.seek=function(e){if(!He)return!1;if(!U)return!1;if(n.disableSongSkip)return!1;if(!n.allowSeeking)return!1;if(y)try{y.currentTime=e}catch(e){console.log(e)}},this.seekBackward=function(e){if(!He)return!1;if(!U)return!1;var t=e||n.seekTime;if(t=parseInt(t,10),y)try{y.currentTime=Math.max(y.currentTime-t,0)}catch(e){console.log(e)}},this.seekForward=function(e){if(!He)return!1;if(!U)return!1;if(!n.allowSeeking)return!1;var t=e||n.seekTime;if(t=parseInt(t,10),y)try{y.currentTime=Math.min(y.currentTime+t,y.duration)}catch(e){console.log(e)}},this.getCurrentTime=function(){return!!He&&(!!U&&(y?y.currentTime:0))},this.getDuration=function(){return!!He&&(!!U&&(y?y.duration:void 0))},this.getCurrentMediaUrl=function(){if(!He)return!1;if(!U)return"";var e;e=-1==window.location.href.indexOf("?")?"?":"&";var t="awp-instance="+encodeURIComponent(n.instanceName);if(null!=R.mediaId)var a="&awp-media-id="+R.mediaId;else a="&awp-active-item="+W;return e+t+"&awp-scroll-to-player=1"+a+(lt?"&awp-resume-time="+Math.floor(Ge.getCurrentTime()):"")},this.getSetupDone=function(){return He},this.getCounter=function(){return mt?mt.getCounter():null},this.getPlaylistTransition=function(){return Fe},this.getPlaylistLoaded=function(){return ot},this.getMediaPlaying=function(){return!!He&&st},this.getPlaylistLength=function(){return!!He&&(AWPUtils.isNumber(it)?it:0)},this.getPlaylistItems=function(){if(!He)return!1;var e=[];return F.find(".awp-playlist-item").each((function(){e.push(t(this))})),e},this.getPlaylistData=function(){return tt||null},this.getCurrMediaData=function(){return!!He&&R},this.getSettings=function(){return!!He&&(n||null)},this.getInstanceName=function(){return!!He&&n.instanceName},Ce&&n.continousKey)if(De){if(localStorage.getItem(n.continousKey)){var pa=JSON.parse(localStorage.getItem(n.continousKey));n.activePlaylist=pa.activePlaylist,n.resumeTime=pa.resumeTime,n.volume=pa.volume,n.activeItem=pa.activeItem,n.autoPlay=pa.autoPlay,Se=pa.autoPlay,localStorage.removeItem(n.continousKey)}}else localStorage.removeItem(n.continousKey);return setTimeout((function(){r.length?(console.log("loading query playlist"),Fe=!0,z.show(),"undefined"!=typeof awpPlaylistStartLoad&&awpPlaylistStartLoad(Ge,n.instanceName),it=(nt=r).length,Vt()):AWPUtils.isEmpty(n.activePlaylist)?Kt():Ft(n.activePlaylist)}),50),this}}(jQuery);